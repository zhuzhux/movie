<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
    <script src="js/jquery.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>


    <style>
    	body{max-width: 640px;margin: 0 auto;}
    </style>
    <style>
		.mui-control-content {
			background-color: white;
			min-height: 1015px;
		}
		.mui-control-content .mui-loading {
			margin-top: 50px;
		}
	</style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
	    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	    <h1 class="mui-title"></h1>
	</header>
	<div id="" style="width: 100%;height:auto;margin-top: 40px;">
		<video width="100%" height="200" controls="" id="media" src="">
			
			<!--<source id="video1" src="">-->
			<!--<source id="video1" src="https://dqplayers.duapp.com/bshare/supurl.php?url=zaWq1nBnYazYrJKam5munmSYp1.pZJaUZG5oZ3BlnA,,&ctype=phone">-->

			<object width="" height="" type="application/x-shockwave-flash" data="myvideo.swf">
				<param name="movie" value="myvideo.swf" />
				<param name="flashvars" value="autostart=true&amp;file=myvideo.swf" />
			</object>
			当前浏览器不支持 video直接播放，点击这里下载视频： <a href="myvideo.webm">下载视频</a>
		</video>
		<div id="rUrl">
			
		</div>
		<i id="htmlurl"></i>
	</div>
			
	
	<button id="url">点击播放</button>
	<!--<video id="videoId" src="http://52dy.hanju2017.com/ppvod/4200AA958BE3AAD2E2643E2DFFF0B238.m3u8" width="100%" height="200" controls="controls">-->
		<script>
			mui.init({
				swipeBack: false
			});
			(function($) {
				$('.mui-scroll-wrapper').scroll({
					indicators: false //是否显示滚动条
				});

				$('.mui-input-group').on('change', 'input', function() {
					if (this.checked) {
						sliderSegmentedControl.className = 'mui-slider-indicator mui-segmented-control mui-segmented-control-inverted mui-segmented-control-' + this.value;
						//force repaint
						sliderProgressBar.setAttribute('style', sliderProgressBar.getAttribute('style'));
					}
				});
			})(mui);
			var a = $('.mui-table-view .mui-table-view-cell .mui-media-object').width();
			$('.mui-table-view .mui-table-view-cell .mui-media-object').css({height:a*1.4})
		</script>
</body>
</html>
<script type="text/javascript" charset="utf-8">
      	mui.init();
//B页面onload从服务器获取列表数据；
        window.onload = function(){
            //从服务器获取数据
//http://movie.wxjii.cn
            //业务数据获取完毕，并已插入当前页面DOM；
            //注意：若为ajax请求，则需将如下代码放在处理完ajax响应数据之后；
            mui.plusReady(function(){
                var self = plus.webview.currentWebview();
                var ahref = self.href;
                var headerTitle = self.title;
                localStorage.aHref = ahref;

				getHtmlUrl();
				$('header h1').text(headerTitle);
                //关闭等待框
                plus.nativeUI.closeWaiting();
                //显示当前页面
                mui.currentWebview.show();
				//清空aHref
				localStorage.removeItem("aHref");
				//获取真实地址，输出到页面按钮，传递的值是
                getrUrl($('#htmlurl').attr('src'));
                //点击真实地址按钮，自动播放
				clickrUrl();
				console.log($('#rUrl').html());
            });
        }
        function getrUrl(href_a){
			mui.ajax("http://movie.wxjii.cn/php/movieU2.php",{
				data:{
					aHref:href_a
				},
				async:false,
				dataType:'json',
				type:'post',
				timeout:1000,
				success:function(data){
					var str = '';
					for(var i = 0;i<data.Data.length;i++){
						if(data.Data[i].playname!="xigua"&&data.Data[i].playname!="xigua1"){
							str+='<div><h4>'+data.Data[i].playname+'</h4>';
							for(var j=0;j<data.Data[i].playurls.length;j++){
								str+='<button style="max-width:100%;width:auto;overflow: hidden;text-align: left;" src="'+data.Data[i].playurls[j][1]+'">'+data.Data[i].playurls[j][0]+'</button>';
							}
							str+='<hr/></div>'
						}
					}
					$('#rUrl').html(str);
//					console.log(str);
				}
			});
        }
        
//      没用的
//      function clickUrl123123(href_a){
//			mui.ajax("http://movie.wxjii.cn/php/movieU2.php",{
//				data:{
//					aHref:href_a
//				},
//				async:false,
//				dataType:'json',
//				type:'post',
//				timeout:1000,
//				success:function(data){
//					for(var i = 0;i<data.Data.length;i++){
////						if(data.Data[i].playname=="acfun"){
////							$('#media').attr('src',"https://dqplayers.duapp.com/bshare/supurl.php?url="+data.Data[i].playurls[0][1]+"&ctype=phone");
////						}
//
//						if(data.Data[i].playname=="acfun"){
//							$('#url').text(data.Data[i].playname);
//							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/macfunu8.php?v="+data.Data[i].playurls[0][1]);
//							relUrl(data.Data[i].playname);
//
//						}
//						if(data.Data[i].playname=="yuku"){
//							$('#url').text(data.Data[i].playname);
//							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/mcommon.php?v="+data.Data[i].playurls[0][1]);
//							relUrl(data.Data[i].playname);
//
//						}
//						if(data.Data[i].playname=="bilibili"){
//							$('#url').text(data.Data[i].playname);
//							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/macfun.php?v="+data.Data[i].playurls[0][1]);
//							relUrl(data.Data[i].playname);
//
//						}
//
//						if(data.Data[i].playname=="dusk360"){
//							$('#url').text(data.Data[i].playname);
//							$('#media').attr("src",data.Data[i].playurls[0][1]);
//							$('#media').attr("autoplay","autoplay");
//
//						}
//
//					}
//					console.log($('#url').attr('src'));
//				}
//			});
//      }
//      
        
        
        function getHtmlUrl(){//获取播放页面的地址： http://m.yingshidaquan.cc/play/DQ236764-4-1.html
				mui.ajax("http://movie.wxjii.cn/php/movieU.php",{
					data:{
						aHref:localStorage.aHref,
						type:2
					},
					async:false,
					dataType:'json',
					type:'post',
					timeout:1000,
					success:function(data){
						//赋值给<i>,不显示，用在存储当前视频的第二次详细
						$('#htmlurl').attr('src',data.data[0].href);
					}
				});
			}
        function relUrl(playname){
        	//取真实地址
			mui.ajax("http://movie.wxjii.cn/php/movieU3.php",{
				data:{
					aHref:$('#url').attr('src'),
					playname:playname
				},
				async:true,
				dataType:'text',
				type:'POST',
				timeout:1000,
				success:function(data){
					console.log(data);
					$('#media').attr("src",data);
					$('#media').attr("autoplay","autoplay");
				}
			});
        }
        
		function clickrUrl(){//点击真实地址的按钮
			$('#rUrl>div>button').click(function(){
				var hText = $(this).prevAll("h4:first").text();
				if(hText=="dusk360"){
					$('#media').attr('src',$(this).attr('src'));
					$('#media').attr("autoplay","autoplay");
				}
				if(hText=="yuku"){
					$('#url').text(data.Data[i].playname);
					$('#url').attr('src',"https://dqplayers.duapp.com/bshare/mcommon.php?v="+data.Data[i].playurls[0][1]);
					relUrl(data.Data[i].playname);	
				}
			
			});
		}

        
        $(document).ready(function(){
//      	console.log($('#video1').attr('src'));
        })

    </script>
    
<!--switch (data.Data[i].playname){
case "dusk360":
	$('#url').text(data.Data[i].playname);
	$('#media').attr("src",data.Data[i].playurls[0][1]);
	$('#media').attr("autoplay","autoplay");	
		break;
case "yuku":
							$('#url').text(data.Data[i].playname);
							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/mcommon.php?v="+data.Data[i].playurls[0][1]);
							relUrl(data.Data[i].playname);	
		break;
	default:
		break;
}-->