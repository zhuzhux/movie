<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
    <script src="js/jquery.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>

    
    <style>
    	body{max-width: 640px;margin: 0 auto;}
    </style>
    <style>
		.mui-control-content {
			background-color: white;
			min-height: 1015px;
		}
		.mui-control-content .mui-loading {
			margin-top: 50px;
		}
	</style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
	    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	    <h1 class="mui-title"></h1>
	</header>
	<div id="" style="width: 100%;height:auto;margin-top: 40px;">
		<video width="100%" height="200" controls="" id="media" src="">
			
			<!--<source id="video1" src="">-->
			<!--<source id="video1" src="https://dqplayers.duapp.com/bshare/supurl.php?url=zaWq1nBnYazYrJKam5munmSYp1.pZJaUZG5oZ3BlnA,,&ctype=phone">-->

			<object width="" height="" type="application/x-shockwave-flash" data="myvideo.swf">
				<param name="movie" value="myvideo.swf" />
				<param name="flashvars" value="autostart=true&amp;file=myvideo.swf" />
			</object>
			当前浏览器不支持 video直接播放，点击这里下载视频： <a href="myvideo.webm">下载视频</a>
		</video>
		<i id="htmlurl"></i>
	</div>
	
	<button id="url">点击播放</button>
		<script>
			mui.init({
				swipeBack: false
			});
			(function($) {
				$('.mui-scroll-wrapper').scroll({
					indicators: false //是否显示滚动条
				});

				$('.mui-input-group').on('change', 'input', function() {
					if (this.checked) {
						sliderSegmentedControl.className = 'mui-slider-indicator mui-segmented-control mui-segmented-control-inverted mui-segmented-control-' + this.value;
						//force repaint
						sliderProgressBar.setAttribute('style', sliderProgressBar.getAttribute('style'));
					}
				});
			})(mui);
			var a = $('.mui-table-view .mui-table-view-cell .mui-media-object').width();
			$('.mui-table-view .mui-table-view-cell .mui-media-object').css({height:a*1.4})
		</script>
</body>
</html>
<script type="text/javascript" charset="utf-8">
      	mui.init();
//B页面onload从服务器获取列表数据；
        window.onload = function(){
            //从服务器获取数据
//http://movie.wxjii.cn
            //业务数据获取完毕，并已插入当前页面DOM；
            //注意：若为ajax请求，则需将如下代码放在处理完ajax响应数据之后；
            mui.plusReady(function(){
                var self = plus.webview.currentWebview();
                var ahref = self.href;
                var headerTitle = self.title;
                localStorage.aHref = ahref;

				getHtmlUrl();
				$('header h1').text(headerTitle);
                //关闭等待框
                plus.nativeUI.closeWaiting();
                //显示当前页面
                mui.currentWebview.show();

                $('#url').click(function(){
	            	clickUrl($('#htmlurl').attr('src'));
	            });
                
				localStorage.removeItem("aHref");//清空aHref
            });
        }
        function clickUrl(href_a){
			mui.ajax("http://movie.wxjii.cn/php/movieU2.php",{
				data:{
					aHref:href_a
				},
				async:false,
				dataType:'json',
				type:'post',
				timeout:1000,
				success:function(data){
					for(var i = 0;i<data.Data.length;i++){
//						if(data.Data[i].playname=="acfun"){
//							$('#media').attr('src',"https://dqplayers.duapp.com/bshare/supurl.php?url="+data.Data[i].playurls[0][1]+"&ctype=phone");
//						}
						if(data.Data[i].playname=="acfun"){
							$('#url').text(data.Data[i].playname);
							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/macfunu8.php?v="+data.Data[i].playurls[0][1]);
							relUrl(data.Data[i].playname);

						}
						if(data.Data[i].playname=="yuku"){
							$('#url').text(data.Data[i].playname);
							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/mcommon.php?v="+data.Data[i].playurls[0][1]);
							relUrl(data.Data[i].playname);

						}
						if(data.Data[i].playname=="bilibili"){
							$('#url').text(data.Data[i].playname);
							$('#url').attr('src',"https://dqplayers.duapp.com/bshare/macfun.php?v="+data.Data[i].playurls[0][1]);
							relUrl(data.Data[i].playname);

						}

						if(data.Data[i].playname=="dusk360"){
							$('#url').text(data.Data[i].playname);
							$('#url').attr('src',"http://dqplayers.duapp.com/bshare/mm3u8.php?v="+data.Data[i].playurls[0][1]);
							relUrl(data.Data[i].playname);

						}

					}
					console.log($('#url').attr('src'));
				}
			});
        }
        function getHtmlUrl(){
				mui.ajax("http://movie.wxjii.cn/php/movieU.php",{
					data:{
						aHref:localStorage.aHref,
						type:2
					},
					async:false,
					dataType:'json',
					type:'post',
					timeout:1000,
					success:function(data){
	//					console.log(data.data[0].href);//要点击高清链接地址
	//              	console.log(localStorage.aHref );//首页传进来的参数
						$('#htmlurl').attr('src',data.data[0].href);
						console.log(1);
//						console.log(localStorage.aHref);
						console.log($('#htmlurl').attr('src'));
						
	//					localStorage.href_a = href_a;
					 	
					}
			
				});
				
			}
        function relUrl(playname){
        	//取真实地址
			mui.ajax("http://movie.wxjii.cn/php/movieU3.php",{
				data:{
					aHref:$('#url').attr('src'),
					playname:playname
				},
				async:true,
				dataType:'text',
				type:'POST',
				timeout:1000,
				success:function(data){
					console.log(data);
					$('#media').attr("src",data);
					$('#media').attr("autoplay","autoplay");
				}
			});
        }

        
        $(document).ready(function(){
//      	console.log($('#video1').attr('src'));
        })

    </script>
    
